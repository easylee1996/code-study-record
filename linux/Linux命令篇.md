---
创建时间: 2023-03-14T19:08
更新时间: 2023-11-23T11:47
---
# 常用指令

## 获取帮助信息

- man [指令]：获取外部命令帮助信息，有手册
- help [指令]：获取内部命令帮助信息，多用于系统命令

其实感觉差不多，但是 man 看起来更好用

## 文件和目录

### 创建

| 命令  | 选项 | 参数       | 示例                 | 说明                               |
| ----- | ---- | ---------- | -------------------- | ---------------------------------- |
| mkdir |      | 目录名     | mkdir hello          | 创建文件夹                         |
|       | -p   | 多级目录名 | mkdir -p hello/hello | 创建多级目录 (-p 表示多级一起创建) |
| touch |      | 文件名     | touch test.txt       | 创建空文件                         |

### 显示

| 命令 | 选项 | 参数 | 示例  | 说明                        |
| ---- | ---- | ---- | ----- | --------------------------- |
| pwd  |      |      | pwd   | 显示当前目录聚堆路径        |
| ls   |      |      | ls    | 列出当前目录下文件          |
|      | -a   |      | ls -a | 包含隐藏                    |
|      | -l   |      | ls -l | 以列表形式显示(ll 简便写法) |

### 删除

| 命令  | 选项 | 参数   | 示例        | 说明                     |
| ----- | ---- | ------ | ----------- | ------------------------ |
| rmdir |      | 目录名 | rmdir hello | 删除空目录               |
| rm    | -rf  | 目录名 | rm -rf test | 删除非空目录(慎用)       |
|       | -r   | 目录名 | rm -r test  | 递归删除整个文件夹       |
|       | -f   | 目录名 | rm -f test  | 强制删除不提示，忽略提示 |

### 复制

| 命令 | 选项 | 参数            | 示例                       | 说明                                               |
| ---- | ---- | --------------- | -------------------------- | -------------------------------------------------- |
| cp   |      | 源路径 目标路径 | cp text.txt test/hello.txt | 复制文件到新路径                                   |
|      | -r   | 源路径 目标路径 | cp -r test test/test       | 递归复制，将整个目录的文件全部复制                 |
| \cp  | -r   | 源路径 目标路径 | \cp -r test hello          | 递归复制，强制覆盖，用cp会手动一个一个确认是否覆盖 |

### 移动和重命名

| 命令 | 选项 | 参数            | 示例         | 说明               |
| ---- | ---- | --------------- | ------------ | ------------------ |
| mv   |      | 源路径 目标路径 | mv test test | 移动可以用于重命名 |

### 查看指令

| 命令 | 选项    | 参数       | 示例                  | 说明                                             |
| ---- | ------- | ---------- | --------------------- | ------------------------------------------------ |
| cat  |         | 查看的文件 | cat hello.txt         | 只读方式查看文件                                 |
|      | -n      | 查看的文件 | cat -n hello.txt      | 显示行号                                         |
|      | \| more | 查看的文件 | cat hello.txt \| more | 分页浏览(管道命令放在后面)                       |
| more |         | 查看的文件 | more hello.txt        | vi编辑器的文本过滤器查看(分页)                   |
| less |         | 查看的文件 | less hello.txt        | 分屏加载，非一次性加载分屏显示，适合查看大型文件 |
| head |         | 查看的文件 | head hello.txt        | 显示前 10 行                                     |
|      | -n 5    | 查看的文件 | head -n 5 hello.txt   | 显示前 5 行                                      |
| tail |         | 查看的文件 | tail hello.txt        | 显示末尾 10 行                                   |
|      | -n 5    | 查看的文件 | tail -n 5 hello.txt   | 显示末尾 5 行                                    |
|      | -f      | 查看的文件 | tail -f hello.txt     | 实时查看文档更新，**工作常用**                   |

**more 使用快捷键**

| 快捷键 | 功能                     |
| ------ | ------------------------ |
| space  | 下翻一页                 |
| Enter  | 下翻一行                 |
| q      | 退出                     |
| =      | 输出当前行的行号         |
| :f     | 输出文件名和当前行的行号 |

**less 快捷键**

| 快捷键   | 功能                              |
| -------- | --------------------------------- |
| space    | 下翻一页                          |
| PageDown | 下翻一页                          |
| PageUp   | 上翻一页                          |
| /字符串  | 向下搜寻字符串 n:下一个 N：上一个 |
| ?字符串  | 向上搜寻字符串 n:下一个 N：上一个 |
| q        | 退出                              |

### 输出命令

| 命令 | 选项 | 参数                  | 示例                      | 说明                                                |
| ---- | ---- | --------------------- | ------------------------- | --------------------------------------------------- |
| >    |      | [源内容] > [输出文件] | ls -l > a.txt             | 输出重定向，将 ls -l 显示的信息输出到重定向到 a.txt |
| >>   |      | [源内容] > [输出文件] | cat /etc/profile >> a.txt | 追加输出，> 是覆盖输出，当然其它命令都可以          |
| echo |      | 输出内容              | echo $PATH                | 输出字符串到命令行窗口                              |
|      |      |                       | echo "hello" > a.txt      | 输出字符串到文件                                    |

### 软连接

| 命令 | 选项 | 参数                      | 示例                | 说明             |
| ---- | ---- | ------------------------- | ------------------- | ---------------- |
| ln   | -s   | [源目录或文件] [软链接名] | ln /root linkToRoot | 建立一个快捷方式 |

跳转到软连接后，使用 pwd 查看路径仍然是软连接的路径，而不是源目录 root 的路径

### 指令历史

| 命令      | 选项 | 参数 | 示例       | 说明                         |
| --------- | ---- | ---- | ---------- | ---------------------------- |
| history   |      |      | history    | 查看输入指令的历史记录       |
|           | 10   |      | history 10 | 查看10条                     |
| !历史编号 |      |      | !137       | 执行上面历史记录的编号的命令 |

### 搜索查找

| 命令     | 选项       | 参数                      | 示例                       | 说明                                              |
| -------- | ---------- | ------------------------- | -------------------------- | ------------------------------------------------- |
| find     | [搜索范围] | 文件名                    | find hello.txt             | 搜索文件                                          |
|          | -name      | 文件名                    | find /home -name hello.txt | 搜索/home 下文件                                  |
|          | -name      | 文件名                    | find /home -name *.txt     | 查询指定后缀的文件                                |
|          | - user     | 用户名                    | find /opt -user nobody     | 搜索 /opt 下用户名称为 nobody的文件               |
|          | - size     | +20M(大于) -20M(小于) 20M | find / -size +300M         | 搜索所有目录下大于 300M 的文件                    |
| updatedb |            |                           | updatedb                   | 创建 locate 定位数据库                            |
| locate   |            | 搜索文件                  | locate hello.txt           | 快速定位 hello.txt 文件位置，必须先创建定位数据库 |

### 管道查找

任何命令都可以添加管道命令，也就是相当于 Java 中的串联命令，添加在命令后面，用于过滤查找

如：cat 命令

```shell
cat hello.txt | grep -n yes
```

| 添加管道命令 grep 过滤 yes 为查找的内容

| 选项 | 功能             |
| ---- | ---------------- |
| -n   | 显示匹配行及行号 |
| -i   | 忽略大小写       |

### 压缩/解压

| 命令   | 选项 | 参数       | 示例                             | 说明                         |
| ------ | ---- | ---------- | -------------------------------- | ---------------------------- |
| gzip   |      | 压缩文件名 | gzip hello.txt                   | 将文件压缩为 *.gz 的压缩文件 |
| gunzip |      | 解压文件名 | gunzip hello.txt.gz              | 解压文件                     |
| zip    |      |            |                                  | 压缩文件                     |
|        | -r   |            | zip -r demo.zip /test            | 压缩目录                     |
| unzip  |      |            |                                  | 解压文件                     |
|        | -d   |            | unzip -d /test demo.zip          | 解压文件并指定存放目录       |
| tar    |      |            |                                  | 压缩系列操作                 |
|        | -c   |            |                                  | 压缩文件                     |
|        | -v   |            |                                  | 显示详细信息                 |
|        | -f   |            |                                  | 指定压缩后的文件名           |
|        | -z   |            |                                  | 打包同时压缩                 |
|        | -x   |            |                                  | 解压文件                     |
|        |      |            | tar -zcvf a.tar.gz a1.txt a2.txt | 压缩多个文件                 |
|        |      |            | tar -zcvf myhome.tar.gz /home    | 压缩目录                     |
|        |      |            | tar -zxvf a.tar.gz               | 解压到当前目录               |
|        |      |            | tar -zxvf a.tar.gz -C /test      | 解压到 test 目录             |

> gzip 命令不会进行打包压缩，也就是不会压缩目录，就算压缩了目录使用 -r 也只是递归把所有的文件分别压缩
>
> tar 常用选项 压缩 -zcvf 解压 -zxvf 也就是 c 和 x 的区别

## 时间日期

| 命令 | 选项 | 参数                | 示例                          | 说明             |
| ---- | ---- | ------------------- | ----------------------------- | ---------------- |
| date |      |                     | date                          | 查看当前时间     |
|      |      | "+%Y"               | date "+%Y"                    | 当前年份         |
|      |      | "+%m"               | date "+%m"                    | 当前月份         |
|      |      | "+%d"               | date "+%d"                    | 当前那一天       |
|      |      | "+%Y %m %d"         | date "+%Y %m %d"              | 当前年月日       |
|      |      | "+%Y-%m-%d%H:%M:%S" | date "+%Y-%m-%d %H:%M:%S"     | 年月日时分秒     |
|      | -s   | 2022-06-09 08:18:27 | date -s "2022-06-09 08:18:27" | 修改当前系统时间 |
| cal  |      |                     | cal                           | 显示本月日历     |
|      |      | 2020                | cal 2020                      | 显示 2020 年日历 |

## 网络情况

| 命令    | 选项 | 参数 | 示例                      | 说明               |
| ------- | ---- | ---- | ------------------------- | ------------------ |
| netstat |      |      |                           | 查看网络服务       |
|         | -an  |      |                           | 按一定顺序输出     |
|         | -p   |      |                           | 显示哪个进程在调用 |
|         |      |      | netstat -anp \| grep sshd | 查看 sshd 网络情况 |

### 信息简单说明

![image-20220610113941586](image-20220610113941586.png)

**上面第一个 ip 地址后面的端口为监听的端口，后面有显示 LISTEN**

# 系统管理

## 关机和重启

| 命令     | 选项 | 参数 | 示例            | 说明                                         |
| -------- | ---- | ---- | --------------- | -------------------------------------------- |
| shutdown | -h   | now  | shutdown -h now | 立即关机                                     |
|          | -h   | 1    | shutdown -h 1   | 1 分钟后关机                                 |
|          | -r   | now  | shutdown -r now | 立即重启                                     |
| halt     |      |      | halt            | 直接关机                                     |
| reboot   |      |      | reboot          | 直接重启                                     |
| sync     |      |      | sync            | 将内存数据同步磁盘，关机重启前应尽量写入磁盘 |

## 登陆和注销

| 命令   | 参数 | 说明     |
| ------ | ---- | -------- |
| logout |      | 注销用户 |

> 在登陆时尽量不要选择 root 用户，要使用管理权限直接使用 su 命令即可

# 用户和权限管理

## 用户管理

### 用户添加

| 命令    | 选项 | 参数              | 示例                     | 说明                   |
| ------- | ---- | ----------------- | ------------------------ | ---------------------- |
| useradd |      | 用户名            | useradd xm               | 添加用户               |
|         | -d   | [目录] [用户名]   | useradd -d /home/dog dog | 指定家目录             |
|         | -g   | [用户组] [用户名] | useradd -g hello hello   | 指定用户组(需先创建组) |

### 管理用户

| 命令    | 选项 | 参数              | 示例                     | 说明                                       |
| ------- | ---- | ----------------- | ------------------------ | ------------------------------------------ |
| usermod | -g   | [用户组] [用户名] | usermod -g hello easylee | 将 easylee 指定到 hello用户组              |
|         | -d   | [目录名] [用户名] | usermod -d /home easylee | 改变用户登录时的初始目录(并不是更换家目录) |
| passwd  |      | 密码              | passwd xm                | 指定密码                                   |
| userdel |      | 用户名            | userdel xm               | 删除用户                                   |
|         | -r   | 用户名            | userdel -r xm            | 删除用户以及家目录                         |

### 其它命令

| 命令 | 选项 | 参数   | 示例         | 说明               |
| ---- | ---- | ------ | ------------ | ------------------ |
| id   |      | 用户名 | id easylee   | 查询用户           |
| su   | -    | 用户名 | su - easylee | 切换用户           |
| exit |      | 用户名 | exit         | 退出 su 切换的用户 |

## 用户组管理

| 命令     | 选项 | 参数 | 示例           | 说明       |
| -------- | ---- | ---- | -------------- | ---------- |
| groupadd |      | 组名 | groupadd hello | 添加用户组 |
| groupdel |      | 组名 | groupdel hello | 删除组     |

## 用户相关配置文件

- /etc/passwd：记录用户的各种信息(最后一行)

```shell
easylee:x:1000:1000:easylee:/home/easylee:/bin/bash
```

用户名:口令:用户标识号:组标识号:注释性描述:主目录:登录 Shell

- /etc/shadow：口令的配置文件(最后一行)

登录名:加密口令:最后一次修改时间:最小时间间隔:最大时间间隔:警告时间:不活动 时间:失效时间:标志

- /etc/group：组配置文件(看最后几行)

组名:口令:组标识号:组内用户列表

## 文件/目录 所有者管理

### 修改文件目录所有者所有组

| 命令  | 选项 | 参数          | 示例                          | 说明                                     |
| ----- | ---- | ------------- | ----------------------------- | ---------------------------------------- |
| chown |      | 用户名 文件名 | chown easylee app.txt         | 修改文件**所有者**                       |
|       | -R   |               | chown -R easylee test         | 如果是目录，递归设置所有子文件和子目录   |
|       |      |               | chown easylee:easylee app.txt | 同时修改所有者和所有组                   |
| chgrp |      | 用户组 文件名 | chgrp easylee app.txt         | 修改文件所有者**用户组**                 |
|       | -R   |               | chgrp  -R bandit test/        | 将test/下的所有文件都修改成bandit 用户组 |

### 修改文件目录权限

| 命令  | 选项 | 参数            | 示例                          | 说明                                                         |
| ----- | ---- | --------------- | ----------------------------- | ------------------------------------------------------------ |
| chmod |      | 权限设置 文件名 |                               | 修改文件或者目录的权限 **u:所有者 g:所有组 o:其他人**        |
|       |      |                 | chmod u=rwx,g=rx,o=rx app.txt | 所有者7权限，所有组5，其他人5                                |
|       |      |                 | chmod u-x,g+w app.txt         | **所有者去除执行权限，所有组中的用户添加写入权限**           |
|       |      |                 | chmod 755 app.txt             | 使用数字指定 所有者所有权限，所有组可读可执行，其他人可读可执行 |

# 任务调度

| 命令    | 选项  | 参数    | 示例                  | 说明               |
| ------- | ----- | ------- | --------------------- | ------------------ |
| crontab |       |         |                       | 编辑定时任务       |
|         | -e    |         | crontab -e            | 编辑定时任务       |
|         | -l    |         | crontab -l            | 查询定时任务       |
|         | -r    |         | crontab -r            | 删除用户下所有任务 |
| service | crond | restart | service crond restart | 重启任务调度       |

输入命令后，是打开一个编辑文件，命令一行一个

> 可以将命令输入到一个 .sh 文件中，然后任务调度直接执行这个文件即可，更加方便

下面是一些基础示例：

1. 每分钟输出当前时间到文件 mydate 中
   - 创建执行 .sh 文件：`touch mytask1.sh`
   - 创建可执行权限：chmod 744 mytask1.sh
   - 编写命令：`vim mytask1.sh` 
   - 写入：date >> /root/test/mydate
   - 创建任务调度：`crontab -e`
   - 写入任务调度表达式：`* * * * * /root/test/mytask1.sh`
2. 每隔一分钟表达式

```shell
*/1 * * * * /root/test/mytask1.sh
```

3. 每天凌晨 2 点，备份数据库到文件中

- 编写可执行文件：

```shell
/usr/local/mysql/bin/mysqldump -u root -proot testdb > /tmp/mydb.bak
```

- 编写任务调度代码

```shell
0 2 * * *  /root/test/mytask1.sh
```

# 进程管理

## 查看进程

### ps -aux 查看

| 命令 | 选项 | 参数    | 示例                 | 说明                           |
| ---- | ---- | ------- | -------------------- | ------------------------------ |
| ps   |      |         |                      | 查看进程信息                   |
|      | -a   |         | ps -a                | 当前终端所有进程信息           |
|      | -u   |         | ps -u                | 以用户格式显示                 |
|      | -x   |         | ps -x                | 显示后台进程                   |
|      |      |         | ps -aux              | **常用**                       |
|      |      | \| grep | ps -aux \| grep sshd | **管道筛选有没有运行什么服务** |
|      | -e   |         | ps -e                | 显示所有进程                   |
|      | -f   |         | ps -f                | 全格式显示                     |
|      |      |         | ps -ef               | **全格式显示所有进程**         |

**信息说明**

![image-20220610101743749](image-20220610101743749.png)

| 字段    | 说明                  |
| ------- | --------------------- |
| USER    | 用户名称              |
| PID     | 进程号                |
| %CPU    | 占用 CPU 百分比       |
| $MEM    | 占用内存百分比        |
| VSZ     | 占用虚拟内存(KB)      |
| RSS     | 占用物理内存(KB)      |
| TTY     | 终端名称，缩写        |
| STAT    | 进程状态              |
| START   | 启动时间              |
| TIME    | 进程使用 CPU 的总时间 |
| COMMAND | 启动进程使用的命令    |

**进程状态说明**

| 状态值 | 说明                                                         |
| ------ | ------------------------------------------------------------ |
| S      | 睡眠                                                         |
| s      | 表示是会话的先导进程，也就是是这条进程执行了才会执行其它进程 |
| N      | 优先级更低                                                   |
| R      | 运行中                                                       |
| D      | 短期等待                                                     |
| Z      | 僵死进程                                                     |
| T      | 被跟踪或者被停止                                             |

**常用：S 休眠 R 运行**

### ps -ef 查看

| 命令 | 选项 | 参数 | 示例                | 说明                   |
| ---- | ---- | ---- | ------------------- | ---------------------- |
| ps   |      |      |                     | 查看进程信息           |
|      | -e   |      | ps -e               | 显示所有进程           |
|      | -f   |      | ps -f               | 全格式显示             |
|      |      |      | ps -ef              | **全格式显示所有进程** |
|      |      |      | ps -ef \| grep sshd |                        |

**信息说明**

![image-20220610103211435](image-20220610103211435.png)

| 字段  | 说明                                                         |
| ----- | ------------------------------------------------------------ |
| UID   | 用户 ID                                                      |
| PID   | 进程 ID                                                      |
| PPID  | 父进程 ID                                                    |
| C     | 数值越大 CPU密集运算 **优先级低**，数值越小 I/O 密集运算 **优先级高** |
| STIME | 进程启动时间                                                 |
| TTY   | 完整终端名称                                                 |
| TIME  | CPU 运行时间                                                 |
| CMD   | 启动进程所用参数                                             |

**注意，这个命令可以查看父进程，但是无法查看进程状态**

### pstree

| 命令   | 选项 | 参数 | 示例      | 说明               |
| ------ | ---- | ---- | --------- | ------------------ |
| pstree |      |      |           | 以进程树方式查看   |
|        | -p   |      | pstree -p | 显示进程的 PID     |
|        | -u   |      | pstree -u | 显示进程的所属用户 |

## 终止进程

| 命令    | 选项 | 参数     | 示例         | 说明                                                   |
| ------- | ---- | -------- | ------------ | ------------------------------------------------------ |
| kill    |      | 进程号   |              | 终止进程                                               |
|         | -9   |          | kill -9 999  | 立即停止                                               |
| killall |      | 进程名称 | killall sshd | 终止进程名称的所有进程，有的程序有多个进程，支持通配符 |

## 服务管理

服务本质是运行在后台的进程，通常会**监听某个端口**，等待请求，比如 mysql 等，一直监听，一直等待响应，也成为守护进程。

> CentOS 6 使用的命令是 service
>
> CentOS 7 使用的命令是 systemctl
>
> 要注意两者的使用方式不同了

### 基本命令

| 命令      | 选项    | 参数                | 示例            | 说明                                                        |
| --------- | ------- | ------------------- | --------------- | ----------------------------------------------------------- |
| systemctl |         | 服务名(xxx.service) |                 | 服务管理                                                    |
|           | start   |                     | systemctl start | 启动                                                        |
|           | restart |                     |                 | 重启                                                        |
|           | stop    |                     |                 | 停止                                                        |
|           | reload  |                     |                 | 重新加载                                                    |
|           | status  |                     |                 | **查看状态 这里是服务详情信息，下面的是开机启动状态的查询** |
|           | enable  |                     |                 | 开机启动                                                    |
|           | disable |                     |                 | 取消开机启动                                                |

### 查看服务自启动状态

| 命令      | 选项            | 参数 | 示例                                    | 说明                 |
| --------- | --------------- | ---- | --------------------------------------- | -------------------- |
| systemctl | list-unit-files |      | systemctl list-unit-files               | 查看服务开机启动状态 |
|           |                 |      | systemctl list-unit-files \| grep ngnix | 查看 ngnix 启动状态  |

状态说明

| 状态     | 说明                                 |
| -------- | ------------------------------------ |
| enabled  | 允许开机启动                         |
| disabled | 禁止开机启动                         |
| static   | 和其它服务关联，不能单独设置启动状态 |

### 防火墙

- 启动：`systemctl start firewalld.service`
- 停止：`systemctl stop firewalld.service`

- 禁止开机自启动(不设置就算停止了重启会再次启动)：`systemctl disable firewalld.service`

- 通过具体端口：`iptables -I INPUT -p tcp —dport 2181 -j ACCEPT`

# RPM 和 YUM

## rpm 包管理器

rpm用于管理本地包，也就是相当于本地软件的增删

### 查询指令

| 命令 | 选项 | 参数       | 示例                   | 说明               |
| ---- | ---- | ---------- | ---------------------- | ------------------ |
| rpm  |      | 包名       |                        | 查询 rpm 包        |
|      | -q   |            | rpm -q firefox         | 查询指定包         |
|      | -qi  |            |                        | 查询包信息         |
|      | -ql  |            |                        | 查询包内有什么文件 |
|      | -qa  |            | rpm -qa \| grep python | 查询所有包         |
|      | -qf  | 文件路径名 | rpm -qf /etc/passwd    | 查询文件属于什么包 |

### 卸载指令

| 命令 | 选项 | 参数     | 示例                    | 说明                                               |
| ---- | ---- | -------- | ----------------------- | -------------------------------------------------- |
| rpm  |      | 包名     |                         | 卸载 rpm 包                                        |
|      | -e   |          | rpm -e firefox          | 卸载 firefox 包                                    |
|      | -e   | --nodeps | rpm -e --nodeps firefox | 强制卸载，如果有包依赖当前包，直接无法卸载(不推荐) |

### 安装指令

| 命令 | 选项 | 参数             | 示例                                              | 说明         |
| ---- | ---- | ---------------- | ------------------------------------------------- | ------------ |
| rpm  |      | **包全路径名称** |                                                   | 安装 rpm 包  |
|      | -i   |                  |                                                   | 安装         |
|      | -v   |                  |                                                   | 提示         |
|      | -h   |                  |                                                   | 进度条       |
|      | -ivh |                  | `rpm -ivh firefox-45.0.1-1.el6.centos.x86_64.rpm` | 常用安装指令 |

## yum 包下载器

yum 是基于 rpm 包管理器的，可以从互联网下载包，并自动处理**依赖关系**

| 命令 | 选项 | 参数    | 示例                   | 说明                   |
| ---- | ---- | ------- | ---------------------- | ---------------------- |
| yum  |      |         |                        | 包下载                 |
|      |      | list    | yun list\|grep firefox | 查询服务器软件以及版本 |
|      |      | install | yum install firefox    | 下载安装最新版本       |

**安装指定版本**

yum list 获取信息如下：(前面包名和系统版本，中间为版本，最后为状态)

![image-20220610131314714](image-20220610131314714.png)

安装格式如下：

`yum install firefox-52.2.0-2.el7.centos.x86_64`

(包名-版本.系统版本)